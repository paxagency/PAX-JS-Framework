var $pax=function(t){};$pax.prototype={url:[],routes:{},routeTags:{},routeHash:0,apps:{},appLength:0,appIndex:0,routeFade:1,routeMove:1,appGlob:[],appInit:[],el:{routes:"#routes"},loadTemplate:`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="position:absolute; left:50%; top:50%;max-width:50px; margin-left:-25px;margin-top:-125px; display: block; shape-rendering: auto;" width="100px" height="100px" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid"><circle cx="50" cy="50" fill="none" stroke="blue" stroke-width="4" r="35" stroke-dasharray="164.93361431346415 56.97787143782138"><animateTransform attributeName="transform" type="rotate" repeatCount="indefinite" dur="1s" values="0 50 50;360 50 50" keyTimes="0;1"></animateTransform></circle></svg>`,init:function(t){var e=this;document.querySelectorAll("template").forEach(function(t){var a=t.getAttribute("app"),r=t.innerHTML;if(void 0!==a){var i=a.split("_").join("/");a=a.split("-").join("_"),"index"==i&&(i=""),e.apps[a]||(e.apps[a]={}),e.apps[a].template||(e.apps[a].template=r),e.apps[a].url||(e.apps[a].url="/"+i)}}),Object.entries(this.apps).forEach(function([t,a]){e.setDefaults(a),a.url?(e.routes[a.url]=t,a.root=e.el.routes):a.global?e.appGlob.push(t):a.ignore||e.appInit.push(t)}),this.setRouter(),this.loadApps(e.appGlob,function(){0===Object.keys(e.routes).length?e.loadApps(e.appInit):e.routing()}),Object.entries(this.apps).forEach(function([t,a]){e.mirror(t)})},setDefaults:function(t){return t.root=t.root?t.root:0,t.el=t.el?t.el:{},t.tag=t.tag?t.tag:{},t.data=t.data?t.data:{},t.values=t.values?t.values:{},t.str=t.str?t.str:{},t.templates=t.templates?t.templates:{},t.filters=t.filters?t.filters:{},t.change=t.change?t.change:{},t},loadApps:function(t,e){var a=this,r=t.length,i=0;!t.length&&e&&e(),t.forEach(function(t){var n=a.apps[t];n.init&&n.init(),n.load_total=n.load?Object.keys(n.load).length:0,n.load_index=0,!n.load_total&&(a.initApp(t),++i==r&&e&&e()),n.load&&Object.entries(n.load).forEach(function([s,o]){if(o.url){var l=o.query?o.query:0;a.ajax(o.url,l,function(o){a.setLoad(t,s,o),n.load_index++,n.load_index==n.load_total&&(a.initApp(t),i++),i==r&&n.load_index==n.load_total&&e&&e()})}})})},setLoad:function(t,e,a){var r=this.apps[t];r.load[e].data=a,r.load[e].setData&&(r.data[e]=a.hits?a.hits:a),r.load[e].loaded&&this.call(a,r.load[e].loaded)},call:function(t,e){var a=e.split("."),r=window.app;return a.forEach(function(t){r=r[t]}),t?r(t):r(0)},initApp:function(t){var e=this.apps[t];!e.root&&document.querySelector('[app="'+t+'"]')&&(e.root='[app="'+t+'"]'),e.loaded&&e.loaded(),e.root&&this.renderApp(t),e.ready&&e.ready()},renderApp:function(t){var e=this,a=this.apps[t];a.set=function(e,a,r){pax.set(t,e,a,r)},a.push=function(e,a,r){pax.push(t,e,a,r)},a.pop=function(e,a){pax.pop(t,e,a)},a.render=function(){pax.renderChildren(t)},a.template||(a.template=document.querySelector(a.root).innerHTML),document.querySelectorAll(a.root).forEach(function(a){a.innerHTML=e.rendTemplate(t)}),this.renderChildren(t),a.root==pax.el.routes&&(e.routeFade&&(document.querySelector(a.root).setAttribute("style","transition:none;opacity:0;"),setTimeout(function(){document.querySelector(a.root).setAttribute("style","opacity:1; transition: opacity .3s;")},10)),e.routeMove&&window.scrollTo({top:0,behavior:"smooth"}))},renderChildren:function(t){t&&void 0!==t||alert("NO");var e=this,a=this.apps[t];document.querySelector(a.root).querySelectorAll("[app]").forEach(function(t){}),document.querySelector(a.root).querySelectorAll("[app]").forEach(function(t){t.setAttribute("children",t.getAttribute("bind")),t.removeAttribute("bind")}),document.querySelector(a.root).querySelectorAll("[bind]").forEach(function(r){var i=r.tagName,n=r.getAttribute("bind");if(""==n||(a.el[n]=r,"TEMPLATE"==i))return!1;"SELECT"==i&&r.hasAttribute("multiple")&&(i="MULTIPLE"),"INPUT"==i&&"checkbox"==r.getAttribute("type")&&(i="CHECKBOX"),"INPUT"==i&&"radio"==r.getAttribute("type")&&(i="IGNORE"),"INPUT"==i&&"button"==r.getAttribute("type")&&(i="BUTTON"),"INPUT"==i&&"submit"==r.getAttribute("type")&&(i="BUTTON"),r.getAttribute("bind-type")&&(i=r.getAttribute("bind-type").toUpperCase()),a.tag[n]=i;var s=r.innerHTML;switch(!a.templates[n]&&s.indexOf("{{")>=0&&(a.templates[n]=s),i){case"UL":case"OL":a.templates[n]||(a.templates[n]='<li data-index="{{index}}">{{value}}</li>'),a.data[n]?e.render(t,n):(a.data[n]=[],r.querySelectorAll("li").forEach(function(t){a.data[n].push(t.innerHTML)}));break;case"RADIO":a.templates[n]||(a.templates[n]="<label><input type='radio' value='{{this.id}}' name='"+n+"'>{{this.text}}</label> "),a.data[n]?a.el[n].innerHTML=e.render(t,n):(a.data[n]=[],a.el[n].querySelectorAll('input[name="'+n+'"]').forEach(function(t){a.data[n].push({id:t.value,text:t.innerHTML})})),a.values[n]&&(a.el[n].querySelector('input[name="'+n+'"][value="'+a.values[n].id+'"]').checked=!0),a.el[n].querySelectorAll('input[name="'+n+'"]').forEach(function(a){a.addEventListener("change",function(a){e.setData(t,n)})});break;case"CHECKBOX":if(a.data[n]){var o=document.createElement("input");o.setAttribute("type","checkbox"),o.setAttribute("name",n),o.setAttribute("bind",n);var l=document.createElement("label");l.appendChild(o),l.innerHTML+=a.data[n].text,a.el[n].parentNode.innerHTML=l.outerHTML,a.data[n].id&&(o.checked=!0)}else a.data[n]={id:0,text:r.parentNode.innerHTML};a.el[n].addEventListener("change",function(a){e.setData(t,n)});break;case"INPUT":a.data[n]||0===a.data[n]?r.value=a.data[n]:a.data[n]=r.value,a.el[n].addEventListener("keyup",function(a){e.setData(t,n)});break;case"TEXTAREA":a.data[n]?r.innerHTML=a.data[n]:a.data[n]=r.innerHTML,a.el[n].addEventListener("focusout",function(a){e.setData(t,n)});break;case"SELECT":a.templates[n]||(a.templates[n]="<option value='{{this.id}}'>{{this.text}}</option>"),a.data[n]?a.el[n].innerHTML=e.render(t,n):(a.data[n]=[],a.el[n].querySelectorAll("option").forEach(function(t){a.data[n].push({id:t.value,text:t.innerHTML})})),a.values[n]&&(a.el[n].value=a.values[n].id),a.values[n]||""==a.data[n][0].id||(a.values[n]=a.data[n][0]),a.el[n].addEventListener("change",function(a){e.setData(t,n)});break;case"TABLE":var p=a.templates[n]?a.templates[n]:0,u=a.config&&a.config[n]?a.config[n]:{};a.el[n].innerHTML=e.table(a.data[n],p,u);break;case"TBODY":a.templates[n]||(a.data[n]?(a.templates[n]='<tr data-index="{{index}}" data-id="{{this.id}}">',Object.entries(a.data[n][0]).forEach(function([t,e]){a.templates[n]+="<td>{{this."+t+"}}</td>"}),a.templates[n]+="</tr>"):a.templates[n]='<tr data-index="{{index}}" data-id="{{this.id}}"><td>{{this.name}}</td></tr>'),a.data[n]?e.render(t,n):a.data[n]=[];break;case"MULTIPLE":if(a.templates[n]||(a.templates[n]="<option value='{{this.id}}'>{{this.text}}</option>"),a.data[n]?a.el[n].innerHTML=e.render(t,n):(a.data[n]=[],a.el[n].querySelectorAll("option").forEach(function(t){a.data[n].push({id:t.value,text:t.innerHTML})})),a.values[n]){var c=[];a.values[n].forEach(function(t){c.push(t.id)}),c.length&&(a.el[n].value=c)}a.el[n].addEventListener("change",function(a){e.setData(t,n)});break;default:a.templates[n]||(a.templates[n]="{{value}}"),a.data[n]||(a.data[n]=r.innerHTML),e.render(t,n)}}),document.querySelector(a.root).querySelectorAll("[app]").forEach(function(t){t.querySelectorAll("[children]").forEach(function(t){t.setAttribute("bind",t.getAttribute("children")),t.removeAttribute("children")})})},mirror:function(t){var e=this.apps[t],a=document.querySelectorAll(e.root);if(a.length>1){var r=0,i="";a.forEach(function(t){r?t.innerHTML=i:i=t.innerHTML,r++})}},render:function(t,e){if(!this.apps[t]){alert('App "'+t+'" does not exist');return}if(!e)return this.loadApps([t]);var a=this,r=this.apps[t];r.tag[e];var i=r.data[e];r.filters[e]&&(i=r.filters[e](i));var n="";if(i||(i=""),Array.isArray(i))r.templates[e]?i.forEach(function(i,s){var o=a.cleanString(r.templates[e]);o=(o=(o=o.split("{{index}}").join(s)).split("{{value}}").join(i)).split("{{this").join("{{"+t+".data."+e+"["+s+"]"),n+=o=a.tempString(o,t,i,e,s)}):n=JSON.stringify(i);else if("object"==typeof i){if(r.templates[e]){var s=a.cleanString(r.templates[e]);s=(s=s.split("{{this").join("{{"+t+".data."+e)).split("{{value").join("{{"+t+".data."+e),n+=s=a.tempString(s,t,r.data[e],e)}else n=JSON.stringify(i)}else{var o=i;if(r.templates[e]){var s=a.cleanString(r.templates[e]);s=(s=s.split("{{this").join("{{"+t+".data")).split("{{value").join("{{"+t+".data."+e),n+=s=a.tempString(s,t,r.data[e],e)}else n=o}return document.querySelector(r.root).querySelector("[bind='"+e+"']").innerHTML=n,this.mirror(t),n},rendTemplate:function(t){if(!this.apps[t].template||""==this.apps[t].template||-1==this.apps[t].template.indexOf("{{"))return this.apps[t].template;var e=document.createElement("div");e.innerHTML=this.apps[t].template;var a={};e.querySelectorAll("[bind]").forEach(function(t){var e=Math.random().toString(36).substring(4);t.after(e),t.remove(),a[e]=t.outerHTML});var r=e.innerHTML.toString();return r=r.split("this.").join(t+".data."),r=this.tempString(r,t),Object.entries(a).forEach(function([t,e]){r=r.replace(t,e)}),r},cleanString:function(t){return t=(t=t.toString()).replace(/{{(.*?)}}/gi,function(t){return t=t.replace(/ /g,"")})},tempString:function(t,e,a,r,i){var n=this;return t.replace(/\{\{[^\}]*\}\}/g,function(t,s){return n.tempValue(t,e,a,r,i)})},tempValue:function(s,key,obj,id,n){var self=this;(fun=(s=s.replace("{{","").replace("}}","").replace("()","")).split("("))[1]&&(s=fun[0]);var v=eval("this.apps."+(s=s.split("||"))[0].trim());if("function"==typeof v){if(fun[1]){fun[1]=fun[1].replace(")","");var con=void 0!==n?key+".data."+id+"["+n+"]":key+".data."+id;fun[1]=fun[1].split("this").join(con);var vl=eval("this.apps."+fun[1].trim());v=v(vl)}else v=void 0!==n?v(n,obj):v(obj)}return s[1]&&void 0==v&&(v=s[1].trim()),this.apps[key].filters[id]&&(v=this.apps[key].filters[id](v)),"object"==typeof v&&v&&v.text&&(v=v.text),"object"==typeof v&&v&&v[0]&&v[0].text&&(v=v.map(function(t){return t.text}).join(", ")),void 0!==v?v:""},setData:function(t,e){var a=this.apps[t],r=a.tag[e],i=a.el[e];switch(r){case"RADIO":a.values[e]={id:i.querySelector("input:checked").value,text:i.querySelector('input[value="'+i.value+'"]').innerHTML};break;case"CHECKBOX":var n=i.checked?1:0;a.data[e]=a.values[e]={id:n,text:i.parentNode.innerHTML};break;case"INPUT":case"TEXTAREA":a.values[e]=a.data[e]=i.value;break;case"SELECT":a.values[e]={id:i.value,text:i.options[i.selectedIndex].text};break;case"MULTIPLE":a.values[e]=[],Array.from(i.value).forEach(function(t){a.values[e].push({id:t,text:i.querySelector('option[value="'+t+'"]').innerHTML})});break;default:a.data[e]=i.innerHTML}a.change[e]&&a.change[e](a.data[e],e,t)},setHTML:function(t,e){var a=this,r=this.apps[t],i=r.data[e],n=r.tag[e],s=r.el[e];switch(n){case"UL":s.innerHTML=a.render(t,e);break;case"RADIO":r.values[e]&&(s.querySelector('input[name="'+e+'"][value="'+r.values[e].id+'"]').checked=!0);break;case"CHECKBOX":s.checked=!!i;break;case"INPUT":case"TEXTAREA":s.value=i;break;case"SELECT":r.values[e]||""==r.data[e][0].id||(r.values[e]=r.data[e][0]),r.values[e]&&(s.value=r.values[e].id);break;case"MULTIPLE":if(r.values[e]){var o=[];Array.from(r.values[e]).forEach(function(t){o.push(t.id)}),o.length&&(s.value=o)}break;default:s.innerHTML=i}r.change[e]&&r.change[e](r.data[e]),this.mirror(t)},set:function(t,e,a,r){""==a&&(a=null);var i=this.apps[t];r?this._set(e,r,i.values):(this._set(e,a,i.data),i.values[e]&&delete i.values[e]),e.indexOf(".")>-1&&(e=e.split(".")[0]),i.change[e]&&i.change[e](a,e,t),i.templates[e]&&!r&&this.render(t,e),this.setHTML(t,e)},load:function(t){var e=this;Object.entries(t).forEach(function([t,a]){e.set(t,a)})},setVar:function(t,e,a){if(a){var r=e.split("."),i=r.length-1;this.va[t]||(this.va[t]={});var n=this.va[t];r.forEach(function(t,e){n[t]||(n[t]={}),e==i&&(n[t]=a),n=n[t]})}},push:function(t,e,a,r){""==a&&(a=null);var i=this.apps[t];void 0!==r?i.data[e].splice(r,0,a):i.data[e].push(a),i.change[e]&&i.change[e](i.data[e],e,t),i.templates[e]?this.render(t,e):this.setHTML(t,e)},pop:function(t,e,a){var r=this.apps[t];void 0!==a?r.data[e].splice(a,1):r.data[e].pop(),r.change[e]&&r.change[e](r.data[e],e,t),r.templates[e]?this.render(t,e):this.setHTML(t,e)},getVals:function(t){var e=this,a={};return Array.from(t).forEach(function(t){a[t]=e.data[t]}),a},print:function(t){if(!t)return alert(JSON.stringify(this.data,null,2));alert(JSON.stringify(t,null,2))},log:function(t){window.console.log(t)},href:function(t){window.location.href=t},link:function(t){window.event.metaKey||window.event.ctrlKey?window.open(t,"_blank"):(window.history.pushState(t,t,t),this.setPath(t))},setRouter:function(){var t=this;this.routeHash?window.addEventListener("hashchange",function(){t.setPath()}):window.onpopstate=function(e){t.setPath(e.state)},this.setGetVars(),this.setPath(0,1)},setPath:function(t,e){this.routeHash?(this.path=location.hash.substr(2),this.url=this.path.split("/")):(this.path=t?t.substr(1):window.location.pathname.substr(1),this.url=this.path.split("/")),e||this.routing()},setGetVars:function(){var t=window.location.search.substring(1).split("&");pax.getVars={},t.forEach(function(t){var e=t.split("=");pax.getVars[e[0]]=e[1]})},routing:function(){for(var t="/error",e=0,a="",r="",i=this,n=0,s=this.url.length;n<s;n++)a+=n?"/"+this.url[n]:this.url[n],r+=n?"_"+this.url[n]:this.url[n],this.routes["/"+a]&&(t="/"+a),this.routeTags[r]&&(e=r);if(this.routes[t]){this.routeInit&&this.routeInit();var o=this.routes[t];document.querySelector(this.apps[o].root).innerHTML=i.loadTemplate,this.activeRoute=this.routes[t],this.loadApps([o]),this.routeReady&&this.routeReady(),Object.entries(this.apps).forEach(function([t,e]){e.appReady&&e.appReady()})}},parse:function(t){if("string"!=typeof t)return t;try{return JSON.parse(t)}catch(e){return{error:1,message:"Server Error"}}},ajax:function(t,e,a){var r=this;e?fetch(t,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e}).then(function(t){return t.text()}).then(function(t){r.el.progress&&(r.el.progress.style.display="none"),a&&a(r.parse(t))}).catch(function(t){r.el.progress&&(r.el.progress.style.display="none"),a&&a({error:!0,xhr:t})}):fetch(t).then(function(t){return t.text()}).then(function(t){a&&a(r.parse(t)),r.el.progress&&(r.el.progress.style.display="none")}).catch(function(t){a&&a({error:!0,xhr:t}),r.el.progress&&(r.el.progress.style.display="none")})},_get:function(t,e){if(!t)return"";if(t=t.split("[").join(".").split("]").join("").replace("()",""),e=e||window,0>t.indexOf(".")){var a=void 0!==e[t]?e[t]:"";"object"==typeof a&&a&&a.text&&(a=a.text),"object"==typeof a&&a[0]&&a[0].text&&(a=a.map(function(t){return t.text}).join(", "))}else{var a=t.split(".").reduce(function(t,e){return t?t[e]:""},e);"object"==typeof a&&a.text&&(a=a.text),"object"==typeof a&&a&&a[0]&&a[0].text&&(a=a.map(function(t){return t.text}).join(", "))}return a},_set:function(t,e,a,r){if(!t)return"";if(a=a||window,t.indexOf(".")>-1&&(t=t.split(".")),!Array.isArray(t)||!(t.length>1))return a[t]=e,r;if(a.hasOwnProperty(t[0])&&"object"==typeof a[t[0]]||(a[t[0]]=Number.isInteger(parseInt(t[1]))?[]:{}),"*"!==t[0])return r=r||a[t[0]],this._set(t.slice(1),e,a[t[0]],r);var i=this;Object.entries(a).forEach(function([a,n]){r=r||n,i._set(t.slice(1),e,n,r)})},clone:function(t){var e=JSON.parse(JSON.stringify(t));return Object.entries(t).forEach(function([t,a]){"function"==typeof a&&(e[t]=a)}),e},table:function(t,e,a,r,i){var n=this;if(r||(r="id"),!t.length)return"<table><tbody><tr id='tr-0'><td style='text-align:center;'>There are no results</td></tr></tbody></table>";var s="<table><thead><tr>",o="<tbody>";if(e)e.forEach(function(t){s+=t.thead?"<th>"+t.thead+"</th>":"<th>"+t.id.split("_").join(" ")+"</th>"}),s+="</tr></thead>",t.forEach(function(t,i){var s=a.cl?'onclick="'+a.cl+'(this)"':"";o+=t[r]?"<tr data-id='"+t[r]+"' data-index='"+i+"' "+s+">":"<tr data-id='"+i+"' data-index='"+i+"' "+s+">",e.forEach(function(e){var a=n._get(e.id,t);e.filter&&(a=e.filter(a,t)),o+=null!=a?"<td>"+a+"</td>":"<td></td>"}),o+="</tr>"});else{var l=[];Object.entries(t[0]).forEach(function([t,e]){s+="<th>"+t.split("_").join(" ")+"</th>",l.push(t)}),s+="</tr></thead>",t.forEach(function(t,e){o+=t[r]?"<tr data-id='"+t[r]+"' data-index='"+e+"'>":"<tr data-id='"+e+"' data-index='"+e+"'>",l.forEach(function(e){var a=t[e];"object"==typeof a&&a.text&&(a=a.text),"object"==typeof a&&a[0]&&a[0].text&&(a=a.map(function(t){return t.text}).join(", ")),o+=null!=a?"<td>"+a+"</td>":"<td></td>"}),o+="</tr>"})}return i?o+"</tbody>":s+o+"</tbody></table>"}};var pax=new $pax,app=pax.apps;window.addEventListener("DOMContentLoaded",function(){pax.init()});